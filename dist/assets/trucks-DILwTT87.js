import{R as y,j as e,l as $e,e as Ne,f as Me,P as we,d as qe,g as He,r as j,c as pe,m as Ge,b as be}from"./index-CF_moJuI.js";import{c as J,L as d,I as w,B as z,C as Ke,b as Be,e as We}from"./index-DTGwnuui.js";import{T as Ue,a as Ye,b as ve,c as ye}from"./tabs-D8InaDQk.js";import{N as _e,O as Ze,R as Qe,Q as Xe,V as Je,W as es,B as ee,d as _,e as C,g as k,h as T,i as c,X as ss,l as as,m as rs,n as ls,o as ts,p as is,Y as ns,Z as cs,_ as os,$ as ds,a0 as hs,a1 as ie,a2 as ne,a3 as ce,a4 as oe,a5 as de,a6 as us,a7 as ps,q as xs}from"./DashboardLayout-CKMHQjoS.js";import{C as ms}from"./checkbox-jsghUBLd.js";import{g as V,L as Ce,d as js,p as gs,a as vs}from"./LoadingSpinner-KqaDx3Fq.js";import{F as he}from"./filter-CmfUkVjz.js";import{C as ys}from"./chevron-down-MIaoJtNm.js";import{T as fs,a as Ns,b as fe,c as B,d as ws,e as W}from"./table-dafBRNiR.js";import{M as bs}from"./map-pin-DG9QdLrP.js";import{T as _s}from"./triangle-alert-BvGIUNPI.js";import{L as Cs}from"./lock-BkTkdjKr.js";import{C as ks}from"./clock-majiuHbu.js";import{C as Ts}from"./circle-x-Bqg4jt-4.js";import{R as Ss}from"./refresh-cw-Xv-Z6mV7.js";import{T as As}from"./ThemeAwareDashboardLayout-C8c2BfhP.js";/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=J("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=J("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=J("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=J("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var $="Accordion",Es=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[xe,Ps,Vs]=$e($),[ae,ma]=Me($,[Vs,_e]),me=_e(),ke=y.forwardRef((o,u)=>{const{type:n,...r}=o,x=r,h=r;return e.jsx(xe.Provider,{scope:o.__scopeAccordion,children:n==="multiple"?e.jsx(Ms,{...h,ref:u}):e.jsx($s,{...x,ref:u})})});ke.displayName=$;var[Te,Os]=ae($),[Se,zs]=ae($,{collapsible:!1}),$s=y.forwardRef((o,u)=>{const{value:n,defaultValue:r,onValueChange:x=()=>{},collapsible:h=!1,...l}=o,[m,v]=Ne({prop:n,defaultProp:r??"",onChange:x,caller:$});return e.jsx(Te,{scope:o.__scopeAccordion,value:y.useMemo(()=>m?[m]:[],[m]),onItemOpen:v,onItemClose:y.useCallback(()=>h&&v(""),[h,v]),children:e.jsx(Se,{scope:o.__scopeAccordion,collapsible:h,children:e.jsx(Ae,{...l,ref:u})})})}),Ms=y.forwardRef((o,u)=>{const{value:n,defaultValue:r,onValueChange:x=()=>{},...h}=o,[l,m]=Ne({prop:n,defaultProp:r??[],onChange:x,caller:$}),v=y.useCallback(A=>m((b=[])=>[...b,A]),[m]),S=y.useCallback(A=>m((b=[])=>b.filter(O=>O!==A)),[m]);return e.jsx(Te,{scope:o.__scopeAccordion,value:l,onItemOpen:v,onItemClose:S,children:e.jsx(Se,{scope:o.__scopeAccordion,collapsible:!0,children:e.jsx(Ae,{...h,ref:u})})})}),[qs,re]=ae($),Ae=y.forwardRef((o,u)=>{const{__scopeAccordion:n,disabled:r,dir:x,orientation:h="vertical",...l}=o,m=y.useRef(null),v=qe(m,u),S=Ps(n),b=es(x)==="ltr",O=He(o.onKeyDown,I=>{var K;if(!Es.includes(I.key))return;const H=I.target,F=S().filter(M=>{var q;return!((q=M.ref.current)!=null&&q.disabled)}),i=F.findIndex(M=>M.ref.current===H),p=F.length;if(i===-1)return;I.preventDefault();let g=i;const s=0,f=p-1,E=()=>{g=i+1,g>f&&(g=s)},P=()=>{g=i-1,g<s&&(g=f)};switch(I.key){case"Home":g=s;break;case"End":g=f;break;case"ArrowRight":h==="horizontal"&&(b?E():P());break;case"ArrowDown":h==="vertical"&&E();break;case"ArrowLeft":h==="horizontal"&&(b?P():E());break;case"ArrowUp":h==="vertical"&&P();break}const G=g%p;(K=F[G].ref.current)==null||K.focus()});return e.jsx(qs,{scope:n,disabled:r,direction:x,orientation:h,children:e.jsx(xe.Slot,{scope:n,children:e.jsx(we.div,{...l,"data-orientation":h,ref:v,onKeyDown:r?void 0:O})})})}),se="AccordionItem",[Hs,je]=ae(se),Fe=y.forwardRef((o,u)=>{const{__scopeAccordion:n,value:r,...x}=o,h=re(se,n),l=Os(se,n),m=me(n),v=Ze(),S=r&&l.value.includes(r)||!1,A=h.disabled||o.disabled;return e.jsx(Hs,{scope:n,open:S,disabled:A,triggerId:v,children:e.jsx(Qe,{"data-orientation":h.orientation,"data-state":Pe(S),...m,...x,ref:u,disabled:A,open:S,onOpenChange:b=>{b?l.onItemOpen(r):l.onItemClose(r)}})})});Fe.displayName=se;var De="AccordionHeader",Re=y.forwardRef((o,u)=>{const{__scopeAccordion:n,...r}=o,x=re($,n),h=je(De,n);return e.jsx(we.h3,{"data-orientation":x.orientation,"data-state":Pe(h.open),"data-disabled":h.disabled?"":void 0,...r,ref:u})});Re.displayName=De;var ue="AccordionTrigger",Ie=y.forwardRef((o,u)=>{const{__scopeAccordion:n,...r}=o,x=re($,n),h=je(ue,n),l=zs(ue,n),m=me(n);return e.jsx(xe.ItemSlot,{scope:n,children:e.jsx(Xe,{"aria-disabled":h.open&&!l.collapsible||void 0,"data-orientation":x.orientation,id:h.triggerId,...m,...r,ref:u})})});Ie.displayName=ue;var Le="AccordionContent",Ee=y.forwardRef((o,u)=>{const{__scopeAccordion:n,...r}=o,x=re($,n),h=je(Le,n),l=me(n);return e.jsx(Je,{role:"region","aria-labelledby":h.triggerId,"data-orientation":x.orientation,...l,...r,ref:u,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...o.style}})});Ee.displayName=Le;function Pe(o){return o?"open":"closed"}var Gs=ke,Ks=Fe,Bs=Re,Ve=Ie,Oe=Ee;const Ws=Gs,Z=j.forwardRef(({className:o,...u},n)=>e.jsx(Ks,{ref:n,className:pe("border-b",o),...u}));Z.displayName="AccordionItem";const Q=j.forwardRef(({className:o,children:u,...n},r)=>e.jsx(Bs,{className:"flex",children:e.jsxs(Ve,{ref:r,className:pe("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",o),...n,children:[u,e.jsx(Ge,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Q.displayName=Ve.displayName;const X=j.forwardRef(({className:o,children:u,...n},r)=>e.jsx(Oe,{ref:r,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:e.jsx("div",{className:pe("pb-4 pt-0",o),children:u})}));X.displayName=Oe.displayName;const Us=({searchQuery:o,onSearchChange:u,onApplyFiltersAndSearch:n,onResetFilters:r})=>{var P,G,K,M,q;const[x,h]=j.useState(!1),[l,m]=j.useState({id:null,city:"",state:"",zip:"",status:"",is_reserved:null,length:null,width:null,height:null,weightUnit:"",payload_capacity:null,gross:null,truck_type_id:null,trailer_type_id:null,owner_id:null,driver_id:null,citizenship:"",phone:"",equipment_id:null,door_type:"",signs:"",preferred_load:null,team:null}),[v,S]=j.useState([]),[A,b]=j.useState([]),[O,I]=j.useState([]),[H,F]=j.useState([]),[i,p]=j.useState([]);j.useEffect(()=>{(async()=>{try{const[L,U,t,D,R]=await Promise.all([V("https://api.mjdatsolutions.com/api/drivers"),V("https://api.mjdatsolutions.com/api/owners"),V("https://api.mjdatsolutions.com/api/truck-types"),V("https://api.mjdatsolutions.com/api/trailer-types"),V("https://api.mjdatsolutions.com/api/equipments")]);if(L.ok){const N=await L.json();S(N.data)}if(U.ok){const N=await U.json();b(N.data)}if(t.ok){const N=await t.json();I(N)}if(D.ok){const N=await D.json();F(N)}if(R.ok){const N=await R.json();p(N)}}catch(L){console.error("Error fetching data:",L)}})()},[]);const g=()=>Object.entries(l).filter(([a,L])=>typeof L=="boolean"?L===!0:L===null?!1:L!=="").length,s=(a,L)=>{m(U=>({...U,[a]:L}))},f=()=>{n(l)},E=()=>{m({id:null,city:"",state:"",zip:"",status:"",is_reserved:null,length:null,width:null,height:null,weightUnit:"",payload_capacity:null,gross:null,truck_type_id:null,trailer_type_id:null,owner_id:null,driver_id:null,citizenship:"",phone:"",equipment_id:null,door_type:"",signs:"",preferred_load:null,team:null}),r()};return e.jsxs("div",{className:"bg-background rounded-md border shadow-sm mb-6",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer",onClick:()=>h(!x),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("h3",{className:"font-medium",children:"Truck Filters"}),g()>0&&e.jsx(ee,{variant:"secondary",className:"ml-2",children:g()})]}),e.jsx(ys,{className:`h-5 w-5 text-muted-foreground transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsxs("div",{className:"p-4 border-t",children:[e.jsxs(Ws,{type:"multiple",defaultValue:["general"],className:"w-full",children:[e.jsxs(Z,{value:"general",children:[e.jsx(Q,{className:"text-sm font-medium",children:"General Information"}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"truckNumber",children:"Truck #"}),e.jsx(w,{id:"truckNumber",placeholder:"Enter truck number",value:l.id,onChange:a=>s("id",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"trailer_type_id",children:"Trailer #"}),e.jsx(w,{id:"trailer_type_id",placeholder:"Enter trailer number",value:l.trailer_type_id,onChange:a=>s("trailer_type_id",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"locationCity",children:"Location City"}),e.jsx(w,{id:"locationCity",placeholder:"Enter city",value:l.city,onChange:a=>s("city",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"locationState",children:"Location State"}),e.jsxs(_,{value:l.state,onValueChange:a=>s("state",a),children:[e.jsx(C,{id:"locationState",children:e.jsx(k,{placeholder:"Select state"})}),e.jsxs(T,{children:[e.jsx(c,{value:"AL",children:"Alabama"}),e.jsx(c,{value:"AK",children:"Alaska"}),e.jsx(c,{value:"AZ",children:"Arizona"}),e.jsx(c,{value:"CA",children:"California"}),e.jsx(c,{value:"CO",children:"Colorado"}),e.jsx(c,{value:"FL",children:"Florida"}),e.jsx(c,{value:"GA",children:"Georgia"}),e.jsx(c,{value:"IL",children:"Illinois"}),e.jsx(c,{value:"NY",children:"New York"}),e.jsx(c,{value:"TX",children:"Texas"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"zip",children:"ZIP"}),e.jsx(w,{id:"zip",placeholder:"Enter ZIP code",value:l.zip,onChange:a=>s("zip",a.target.value)})]})]})})]}),e.jsxs(Z,{value:"availability",children:[e.jsx(Q,{className:"text-sm font-medium",children:"Availability Info"}),e.jsx(X,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 pt-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"status",children:"Status"}),e.jsxs(_,{value:l.status,onValueChange:a=>s("status",a),children:[e.jsx(C,{id:"status",children:e.jsx(k,{placeholder:"Select status"})}),e.jsxs(T,{children:[e.jsx(c,{value:"available",children:"Available"}),e.jsx(c,{value:"on-route",children:"On Route"}),e.jsx(c,{value:"maintenance",children:"Maintenance"}),e.jsx(c,{value:"offline",children:"Offline"})]})]})]})})})]}),e.jsxs(Z,{value:"truckDetails",children:[e.jsx(Q,{className:"text-sm font-medium",children:"Truck Details"}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-7 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"length",children:"Length"}),e.jsx(w,{id:"length",type:"number",placeholder:"Length",value:l.length,onChange:a=>s("length",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"width",children:"Width"}),e.jsx(w,{id:"width",type:"number",placeholder:"Width",value:l.width,onChange:a=>s("width",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"height",children:"Height"}),e.jsx(w,{id:"height",type:"number",placeholder:"Height",value:l.height,onChange:a=>s("height",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"payload_capacity",children:"Payload"}),e.jsx(w,{id:"payload_capacity",type:"number",placeholder:"Payload",value:l.payload_capacity,onChange:a=>s("payload_capacity",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"gross",children:"Gross"}),e.jsx(w,{id:"gross",type:"number",placeholder:"Gross",value:l.gross,onChange:a=>s("gross",a.target.value)})]}),e.jsxs("div",{className:"space-y-2 lg:col-span-3",children:[e.jsx(d,{htmlFor:"truckType",children:"Truck Type"}),e.jsxs(_,{value:(P=l.truck_type_id)==null?void 0:P.toString(),onValueChange:a=>s("truckType",Number(a)),children:[e.jsx(C,{id:"truckType",children:e.jsx(k,{placeholder:"Select truck type"})}),e.jsx(T,{children:O.map(a=>e.jsx(c,{value:a.id.toString(),children:a.name}))})]})]}),e.jsxs("div",{className:"space-y-2 lg:col-span-3",children:[e.jsx(d,{htmlFor:"trailer_type_id",children:"Trailer Type"}),e.jsxs(_,{value:(G=l.trailer_type_id)==null?void 0:G.toString(),onValueChange:a=>s("trailer_type_id",Number(a)),children:[e.jsx(C,{id:"trailer_type_id",children:e.jsx(k,{placeholder:"Select trailer type"})}),e.jsx(T,{children:H.map(a=>e.jsx(c,{value:a.id.toString(),children:a.name}))})]})]})]})})]}),e.jsxs(Z,{value:"ownerDriver",children:[e.jsx(Q,{className:"text-sm font-medium",children:"Owner and Driver"}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"owner_id",children:"Owner"}),e.jsxs(_,{value:(K=l.owner_id)==null?void 0:K.toString(),onValueChange:a=>s("owner_id",Number(a)),children:[e.jsx(C,{id:"owner_id",children:e.jsx(k,{placeholder:"Select owner"})}),e.jsx(T,{children:A.length==0?e.jsx(c,{disabled:!0,value:"",children:"No owners found"}):A.map(a=>e.jsx(c,{value:a.id.toString(),children:a.name}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"driver",children:"Driver"}),e.jsxs(_,{value:(M=l.driver_id)==null?void 0:M.toString(),onValueChange:a=>s("driver_id",Number(a)),children:[e.jsx(C,{id:"driver",children:e.jsx(k,{placeholder:"Select driver"})}),e.jsx(T,{children:v.length==0?e.jsx(c,{disabled:!0,value:"",children:"No drivers found"}):v.map(a=>e.jsx(c,{value:a.id.toString(),children:a.name}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"citizenship",children:"Citizenship"}),e.jsxs(_,{value:l.citizenship,onValueChange:a=>s("citizenship",a),children:[e.jsx(C,{id:"citizenship",children:e.jsx(k,{placeholder:"Select citizenship"})}),e.jsxs(T,{children:[e.jsx(c,{value:"citizen",children:"Citizen"}),e.jsx(c,{value:"resident",children:"Resident"}),e.jsx(c,{value:"NL",children:"NL"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone",children:"Phone #"}),e.jsx(w,{id:"phone",placeholder:"Enter phone number",value:l.phone,onChange:a=>s("phone",a.target.value)})]})]})})]}),e.jsxs(Z,{value:"moreDetails",children:[e.jsx(Q,{className:"text-sm font-medium",children:"More Details"}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"equipment_id",children:"Equipment"}),e.jsxs(_,{value:(q=l.equipment_id)==null?void 0:q.toString(),onValueChange:a=>s("equipment_id",Number(a)),children:[e.jsx(C,{id:"equipment_id",children:e.jsx(k,{placeholder:"Select equipment"})}),e.jsx(T,{children:i.map(a=>e.jsx(c,{value:a.id.toString(),children:a.name}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"doorType",children:"Door Type"}),e.jsxs(_,{value:l.door_type,onValueChange:a=>s("door_type",a),children:[e.jsx(C,{id:"doorType",children:e.jsx(k,{placeholder:"Select door type"})}),e.jsxs(T,{children:[e.jsx(c,{value:"roll",children:"Roll"}),e.jsx(c,{value:"swing",children:"Swing"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"signs",children:"Signs"}),e.jsxs(_,{value:l.signs,onValueChange:a=>s("signs",a),children:[e.jsx(C,{id:"signs",children:e.jsx(k,{placeholder:"Select signs"})}),e.jsxs(T,{children:[e.jsx(c,{value:"with_signs",children:"With Signs"}),e.jsx(c,{value:"without_signs",children:"Without Signs"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"preferred_load",children:"Preferred Load"}),e.jsxs(_,{value:l.preferred_load,onValueChange:a=>s("preferred_load",a),children:[e.jsx(C,{id:"preferred_load",children:e.jsx(k,{placeholder:"Select preferred load"})}),e.jsxs(T,{children:[e.jsx(c,{value:"local",children:"Local"}),e.jsx(c,{value:"long",children:"Long"}),e.jsx(c,{value:"any",children:"Any"})]})]})]}),e.jsx("div",{className:"flex items-center space-x-8 pt-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ms,{id:"team",checked:l.team,onCheckedChange:a=>s("team",a)}),e.jsx(d,{htmlFor:"team",children:"Team"})]})})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsxs(z,{variant:"outline",onClick:E,className:"flex items-center",children:[e.jsx(ss,{className:"mr-1 h-4 w-4"})," Reset"]}),e.jsxs(z,{onClick:f,className:"flex items-center",children:[e.jsx(he,{className:"mr-1 h-4 w-4"})," Apply and Search"]})]})]})]})},Ys=({open:o,onOpenChange:u,onSave:n})=>{const[r,x]=y.useState({owner_id:0,license_plate:"",height:0,length:0,width:0,gross:0,city:"",state:"",zip:"",payload_capacity:0,door_type:"",team:!1,address:"",status:"available",preferred_load:"any",canada:!1,mexico:!1,signs:"without_signs",is_reserved:!1,truck_type_id:0,trailer_type_id:0,equipment:[]}),[h,l]=y.useState([]),[m,v]=y.useState([]),[S,A]=y.useState([]),[b,O]=y.useState(0),[I,H]=y.useState(!1),[F,i]=y.useState([]),p=(s,f)=>{s=="driverId"?O(Number(f)):x(E=>({...E,[s]:f})),console.log("form data",r)},g=()=>{n(r,b),x({owner_id:0,license_plate:"",height:0,length:0,width:0,gross:0,city:"",state:"",zip:"",payload_capacity:0,door_type:"",team:!1,address:"",status:"available",preferred_load:"any",canada:!1,mexico:!1,signs:"without_signs",is_reserved:!1,truck_type_id:0,trailer_type_id:0,equipment:[]})};return j.useEffect(()=>{(async()=>{try{const[f,E,P,G]=await Promise.all([V("https://api.mjdatsolutions.com/api/truck-types"),V("https://api.mjdatsolutions.com/api/owners"),V("https://api.mjdatsolutions.com/api/drivers"),V("https://api.mjdatsolutions.com/api/trailer-types")]),K=await f.json();f.ok&&l(K);const M=await E.json();E.ok&&A(M.data);const q=await P.json();P.ok&&v(q.data);const a=await G.json();G.ok&&i(a)}catch(f){console.error(f)}finally{H(!1)}})()},[]),I?e.jsx(Ce,{}):e.jsx(as,{open:o,onOpenChange:u,children:e.jsxs(rs,{children:[e.jsxs(ls,{children:[e.jsx(ts,{children:"Add New Truck"}),e.jsx(is,{children:"Enter the details for the new truck. Click save when you're done."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"license-plate",children:"License Plate"}),e.jsx(w,{id:"license-plate",placeholder:"Plate No.",value:r.license_plate,onChange:s=>p("license_plate",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"truck-type",children:"Type"}),e.jsxs(_,{value:r.truck_type_id.toString(),onValueChange:s=>p("truck_type_id",Number(s)),children:[e.jsx(C,{children:e.jsx(k,{placeholder:"Select type"})}),e.jsx(T,{children:h.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"owner",children:"Truck Owner"}),e.jsxs(_,{value:r.owner_id.toString(),onValueChange:s=>p("owner_id",Number(s)),children:[e.jsx(C,{children:e.jsx(k,{placeholder:"Select owner"})}),e.jsx(T,{children:S.length==0?e.jsx("p",{children:"No owners found"}):S.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"owner",children:"Assign Driver"}),e.jsxs(_,{value:b.toString(),onValueChange:s=>p("driverId",Number(s)),children:[e.jsx(C,{children:e.jsx(k,{placeholder:"Select driver"})}),e.jsx(T,{children:m.length==0?e.jsx("p",{children:"No drivers found"}):m.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"height",children:"Height"}),e.jsx(w,{id:"height",type:"number",value:r.height,onChange:s=>p("height",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"width",children:"Width"}),e.jsx(w,{id:"width",type:"number",value:r.width,onChange:s=>p("width",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"length",children:"Length"}),e.jsx(w,{id:"length",type:"number",value:r.length,onChange:s=>p("length",s.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"city",children:"City"}),e.jsx(w,{id:"city",value:r.city,onChange:s=>p("city",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"width",children:"State"}),e.jsx(w,{id:"state",value:r.state,onChange:s=>p("state",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"length",children:"Zip"}),e.jsx(w,{id:"zip",value:r.zip,onChange:s=>p("zip",s.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"signs",children:"Signs"}),e.jsxs(_,{value:r.signs,onValueChange:s=>p("signs",s),children:[e.jsx(C,{children:e.jsx(k,{placeholder:""})}),e.jsxs(T,{children:[e.jsx(c,{value:"with_signs",children:"With Signs"}),e.jsx(c,{value:"without_signs",children:"Without Signs"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"preferred_load",children:"Preferred Load"}),e.jsxs(_,{value:r.preferred_load,onValueChange:s=>p("preferred_load",s),children:[e.jsx(C,{children:e.jsx(k,{placeholder:"Preferred load"})}),e.jsxs(T,{defaultValue:"any",children:[e.jsx(c,{value:"long",children:"Long"}),e.jsx(c,{value:"local",children:"Local"}),e.jsx(c,{value:"any",children:"Any"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"door-type",children:"Door Type"}),e.jsxs(_,{value:r.door_type,onValueChange:s=>p("door_type",s),children:[e.jsx(C,{children:e.jsx(k,{placeholder:"Door type"})}),e.jsxs(T,{children:[e.jsx(c,{value:"swing",children:"Swing"}),e.jsx(c,{value:"roll",children:"Roll"})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"trailer_type_id",children:"Trailer Type"}),e.jsxs(_,{value:r.trailer_type_id.toString(),onValueChange:s=>p("trailer_type_id",Number(s)),children:[e.jsx(C,{children:e.jsx(k,{placeholder:"Select trailer type"})}),e.jsx(T,{children:F.length==0?e.jsx("p",{children:"No trailers found"}):F.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"payload-capacity",children:"Payload Capacity (lbs)"}),e.jsx(w,{id:"payload-capacity",type:"number",min:"0",placeholder:"0 lbs",value:r.payload_capacity,onChange:s=>p("payload_capacity",Number(s.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"gross",children:"Gross (lbs)"}),e.jsx(w,{id:"gross",type:"number",min:"0",placeholder:"0 lbs",value:r.gross,onChange:s=>p("gross",Number(s.target.value))})]})]})]}),e.jsxs(ns,{children:[e.jsx(z,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(z,{onClick:g,children:"Save Truck"})]})]})})},Zs=j.memo(Ys),Qs=({data:o,onReserve:u,onViewDetails:n,onEdit:r,onArchive:x,onViewLogs:h})=>{const[l,m]=j.useState(null),[v,S]=j.useState("asc"),{user:A}=be(),b=i=>{l===i?S(v==="asc"?"desc":"asc"):(m(i),S("asc"))},O=[...o].sort((i,p)=>{if(!l)return 0;let g,s;switch(l){case"id":g=i.id,s=p.id;break;default:return 0}return g<s?v==="asc"?-1:1:g>s?v==="asc"?1:-1:0}),I=i=>!i||i==="valid"?null:e.jsxs("div",{className:"flex items-center text-xs bg-red-100 text-red-700 px-1 py-0.5 rounded mb-1",children:[e.jsx(_s,{className:"h-3 w-3 mr-1"}),"Doc exp"]}),H=i=>{switch(i){case"available":return e.jsx(ne,{children:e.jsxs(ce,{children:[e.jsx(oe,{asChild:!0,children:e.jsx("div",{className:"flex justify-center",children:e.jsx(us,{className:"h-5 w-5 text-green-500"})})}),e.jsx(de,{children:"Available"})]})});case"busy":return e.jsx(ne,{children:e.jsxs(ce,{children:[e.jsx(oe,{asChild:!0,children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ks,{className:"h-5 w-5 text-amber-500"})})}),e.jsx(de,{children:"Busy"})]})});case"not_available":return e.jsx(ne,{children:e.jsxs(ce,{children:[e.jsx(oe,{asChild:!0,children:e.jsx("div",{className:"flex justify-center",children:e.jsx(Cs,{className:"h-5 w-5 text-gray-500"})})}),e.jsx(de,{children:"Offline"})]})});default:return null}},F=i=>i?e.jsx(ee,{variant:"outline",className:"text-xs px-1 py-0.5 mr-1",children:i}):null;return e.jsx("div",{className:"w-full overflow-auto",children:e.jsxs(fs,{className:"border-collapse w-full",children:[e.jsx(Ns,{children:e.jsxs(fe,{className:"bg-muted/50",children:[e.jsx(B,{className:"cursor-pointer hover:bg-muted/80 transition-colors",onClick:()=>b("id"),children:e.jsxs("div",{className:"flex items-center",children:["TRUCK#"," ",l==="id"&&(v==="asc"?"↑":"↓")]})}),e.jsx(B,{children:"MAIN CONTACT INFO"}),e.jsx(B,{children:"TRUCK INFO"}),e.jsx(B,{children:"DIMS / PAYLOAD"}),e.jsx(B,{className:"text-center",children:"STATUS"}),e.jsx(B,{className:"cursor-pointer hover:bg-muted/80 transition-colors",onClick:()=>b("lastKnown"),children:e.jsxs("div",{className:"flex items-center",children:["LAST KNOWN LOCATION"," ",l==="lastKnown"&&(v==="asc"?"↑":"↓")]})}),e.jsx(B,{className:"text-center",children:"ACTIONS"})]})}),e.jsx(ws,{children:O.length==0?e.jsx("p",{className:"p-5",children:"No trucks found"}):O.map(i=>{var p,g,s,f;return e.jsxs(fe,{className:"border-b hover:bg-muted/30",children:[e.jsxs(W,{className:"font-medium",children:[I(i.documentStatus),"TRK-",i.id]}),e.jsxs(W,{children:[e.jsx("div",{className:"text-gray-500",children:"ow"}),e.jsx("div",{className:"font-medium",children:(p=i.owner)==null?void 0:p.name}),e.jsx("a",{href:`tel:${(g=i.owner)==null?void 0:g.phone}`,className:"text-blue-600 hover:underline text-sm flex items-center",children:(s=i.owner)==null?void 0:s.phone})]}),e.jsx(W,{children:e.jsxs("div",{className:"flex items-center mb-1",children:[F((f=i.owner)==null?void 0:f.language),i.truck_type_name]})}),e.jsxs(W,{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[i.preferred_load=="long"&&e.jsx(ee,{className:"bg-blue-100 text-blue-800 mr-2 text-xs border-0",children:"LONG"}),i.preferred_load=="local"&&e.jsx(ee,{className:"bg-blue-100 text-blue-800 mr-2 text-xs border-0",children:"LOCAL"}),e.jsxs("span",{children:[i.length,'" x ',i.width,'" x ',i.height,'"']})]}),e.jsxs("div",{className:"text-gray-600",children:[i.payload_capacity," lbs"]})]}),e.jsx(W,{className:"text-center",children:H(i.status)}),e.jsx(W,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(bs,{className:"h-4 w-4 text-gray-400 mr-1 flex-shrink-0"}),e.jsxs("span",{children:[i.city,", ",i.state]})]})}),e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[i.is_reserved==0?e.jsx(z,{className:"bg-green-500 hover:bg-green-600 text-white text-xs py-1 h-8",onClick:()=>u&&u(i.id),children:"RESERVE"}):e.jsx(z,{variant:"outline",className:"text-gray-400 border-gray-200 text-xs py-1 h-8",disabled:!0,children:"NO ACTIONS"}),e.jsxs(cs,{children:[e.jsx(os,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",className:"h-8 w-8",children:e.jsx(ds,{className:"h-4 w-4"})})}),A.role=="admin"&&e.jsxs(hs,{align:"end",children:[e.jsxs(ie,{onClick:()=>n&&n(i.id),children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(ie,{onClick:()=>r&&r(i.id),children:[e.jsx(Ls,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(ie,{onClick:()=>x&&x(i.id),className:"text-red-600",children:[e.jsx(Fs,{className:"mr-2 h-4 w-4"}),"Delete Truck"]})]})]})]})})]},i.id)})})]})})},Xs=({user:o,onClose:u})=>{const[n,r]=j.useState("list"),[x,h]=j.useState(""),[l,m]=j.useState(!1),[v,S]=j.useState(null),[A,b]=j.useState(!1),[O,I]=j.useState(null),[H,F]=j.useState(!1),[i,p]=j.useState([]),[g,s]=j.useState({id:"status",name:"Status",options:[{id:"available",label:"Available",checked:!1},{id:"on_route",label:"On Route",checked:!1},{id:"maintenance",label:"Maintenance",checked:!1},{id:"offline",label:"Offline",checked:!1}]}),[f,E]=j.useState({id:"type",name:"Type",options:[{id:"box_truck",label:"Box Truck",checked:!1},{id:"cargo_van",label:"Cargo Van",checked:!1},{id:"refrigerated",label:"Refrigerated",checked:!1},{id:"flatbed",label:"Flatbed",checked:!1},{id:"tanker",label:"Tanker",checked:!1}]}),P=async()=>{F(!0);try{const t=localStorage.getItem("auth-token"),D=await fetch("https://api.mjdatsolutions.com/api/trucks",{headers:{Authorization:`Bearer ${t}`}}),R=await D.json();console.log("trucks response data:",R),D.ok&&p(R)}catch(t){console.error("Error fething trucks",t)}finally{F(!1)}};j.useEffect(()=>{P()},[]);const G=async()=>{s({...g,options:g.options.map(R=>({...R,checked:!1}))}),E({...f,options:f.options.map(R=>({...R,checked:!1}))}),h(""),I(null);const t=await V("https://api.mjdatsolutions.com/api/trucks"),D=await t.json();t.ok?(console.log("data:",D),p(D)):console.error("Error fetching filtered trucks:",t)},K=async t=>{I(t);const D={};Object.entries(t).forEach(([te,Y])=>{Y!==null&&Y!==""&&(D[te]=Y)});const R=new URLSearchParams(D).toString();console.log("query:",R);const N=await V(`https://api.mjdatsolutions.com/api/trucks?${R}`),le=await N.json();N.ok?(console.log("data:",le),p(le)):console.error("Error fetching filtered trucks:",N)},M=async(t,D)=>{console.log("Adding new truck:",t);const R={owner_id:t.owner_id,license_plate:t.license_plate,model:t.model,color:t.color,year:t.year,height:t.height,length:t.length,width:t.width,gross:t.gross,city:t.city,state:t.state,zip:t.zip,payload_capacity:t.payload_capacity,door_type:t.door_type,team:t.team,status:"available",preferred_load:t.preferred_load,is_reserved:!1,canada:t.canada,mexico:t.mexico,signs:t.signs,truck_type_id:t.truck_type_id,trailer_type_id:t.trailer_type_id,equipment:[]};try{F(!0);const N=await gs("https://api.mjdatsolutions.com/api/trucks",R);if(N.status==201){console.log("truck added successfully");const te=(await N.json()).truck,Y=await vs(`https://api.mjdatsolutions.com/api/drivers/${D}`,{truck_id:te.id}),ge=await V("https://api.mjdatsolutions.com/api/trucks");if(ge.ok){const ze=await ge.json();p(ze)}Y.status==200?console.log("driver assigned to truck"):console.log("failed to assign driver:",Y),m(!1)}else console.log(await N.json())}catch(N){console.error(N)}finally{F(!1)}},q=t=>{console.log(`Edit ${t}`),b(!1)},a=t=>{console.log(`Reserve truck ${t}`)},L=t=>{console.log(`View logs for truck ${t}`)},U=async t=>{if((await js(`https://api.mjdatsolutions.com/api/trucks/${t}`)).ok)P(),console.log(`Truck #${t} deleted`);else throw console.log(`Failed to delete Truck #${t}`),new Error("Failed to delete truck")};return H?e.jsx(Ce,{}):e.jsxs(Ke,{className:"w-full  bg-background",children:[e.jsx(Be,{className:"flex flex-row items-center justify-between",children:u&&e.jsx(z,{variant:"ghost",size:"icon",onClick:u,children:e.jsx(Ts,{className:"h-4 w-4"})})}),e.jsxs(We,{children:[e.jsx(Us,{searchQuery:x,onSearchChange:h,onApplyFiltersAndSearch:K,onResetFilters:G}),e.jsxs(Ue,{value:n,onValueChange:r,children:[e.jsxs(Ye,{className:"grid w-full grid-cols-2",children:[e.jsxs(ve,{value:"list",className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-4 w-4"})," Trucks List"]}),e.jsxs(ve,{value:"map",className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"})," General Map"]})]}),e.jsx(ye,{value:"list",className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium"}),e.jsx("div",{className:"flex gap-2",children:o.role=="admin"&&e.jsxs(z,{size:"sm",onClick:()=>m(!0),children:[e.jsx(xs,{className:"h-4 w-4 mr-2"})," Add Truck"]})})]}),e.jsx("div",{className:"border rounded-md mb-8",children:e.jsx(Qs,{data:i,onReserve:a,onViewDetails:q,onEdit:q,onViewLogs:L,onArchive:U})})]})}),e.jsx(ye,{value:"nearby",className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Trucks Nearby"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(z,{variant:"outline",size:"sm",children:[e.jsx(he,{className:"h-4 w-4 mr-2"})," Filter"]}),e.jsxs(z,{variant:"outline",size:"sm",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"})," Refresh"]})]})]}),e.jsx("div",{className:"border rounded-md bg-slate-100 h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Is,{className:"h-16 w-16 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Nearby View Coming Soon"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"This feature is currently under development."})]})})]})})]}),l&&e.jsx(Zs,{open:!0,onOpenChange:t=>m(t),onSave:M})]})]})},ja=()=>{const{user:o}=be();return e.jsx(As,{pageTitle:"Truck Management",children:e.jsxs("div",{className:"w-full h-full",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Trucks"}),e.jsx(Xs,{user:o})]})})};export{ja as default};
